window.__require=function t(o,c,a){function e(n,s){if(!c[n]){if(!o[n]){var r=n.split("/");if(r=r[r.length-1],!o[r]){var l="function"==typeof __require&&__require;if(!s&&l)return l(r,!0);if(i)return i(r,!0);throw new Error("Cannot find module '"+n+"'")}}var d=c[n]={exports:{}};o[n][0].call(d.exports,function(t){return e(o[n][1][t]||t)},d,d.exports,t,o,c,a)}return c[n].exports}for(var i="function"==typeof __require&&__require,n=0;n<a.length;n++)e(a[n]);return e}({block:[function(t,o,c){"use strict";cc._RF.push(o,"382c2FQiARJlKJl53FVdceQ","block");var a=function(t){return t&&t.__esModule?t:{default:t}}(t("colors"));cc.Class({extends:cc.Component,properties:{scoreTitle:cc.Label},setNumber:function(t){0==t&&(this.scoreTitle.node.active=!1),this.scoreTitle.string=t,t in a.default&&(this.node.color=a.default[t])},start:function(){}}),cc._RF.pop()},{colors:"colors"}],colors:[function(t,o,c){"use strict";cc._RF.push(o,"816d5BmrWRK5rSxOgXIvesF","colors");var a=[];a[0]=cc.color(198,184,172,255),a[2]=cc.color(235,224,213,255),a[4]=cc.color(234,219,193,255),a[8]=cc.color(240,167,110,255),a[16]=cc.color(244,138,89,255),a[32]=cc.color(245,112,85,255),a[64]=cc.color(245,83,52,255),a[128]=cc.color(234,200,103,255),a[256]=cc.color(234,197,87,255),a[512]=cc.color(234,192,71,255),a[1024]=cc.color(146,208,80,255),a[2048]=cc.color(0,176,240,255),o.exports=a,cc._RF.pop()},{}],gameover:[function(t,o,c){"use strict";cc._RF.push(o,"bda78GcirBNhKXZZJkmUubO","gameover"),cc.Class({extends:cc.Component,properties:{restart:cc.Node,bg:cc.Node},start:function(){},onLoad:function(){cc.color(0,0,0,0);this.restart.on(cc.Node.EventType.TOUCH_START,function(t){cc.director.loadScene("game")})}}),cc._RF.pop()},{}],game:[function(t,o,c){"use strict";cc._RF.push(o,"6f3b7gEENdCYpzU6istCRQE","game");var a=[2,4];cc.Class({extends:cc.Component,properties:{scoreTitle:cc.Label,score:0,blockPrefab:cc.Prefab,gap:20,background:cc.Node},getblocks:function(){this.positions=[],this.blockSize=(cc.winSize.width-5*this.gap)/4;for(var t=this.blockSize/2+this.gap,o=this.blockSize,c=0;c<4;c++){this.positions.push([0,0,0,0]);for(var a=0;a<4;a++){var e=cc.instantiate(this.blockPrefab);e.width=this.blockSize,e.height=this.blockSize,e.setPosition(cc.v2(t,o)),this.positions[c][a]=cc.v2(t,o),e.getComponent("block").setNumber(0),this.background.addChild(e),t+=this.blockSize+this.gap}o+=this.blockSize+this.gap,t=this.blockSize/2+this.gap}},getEmptyBlocks:function(){for(var t=[],o=0;o<this.blocks.length;o++)for(var c=0;c<this.blocks[o].length;c++)null==this.blocks[o][c]&&t.push([o,c]);return t},addBlock:function(){var t=this.getEmptyBlocks();if(0==t.length)return!1;var o=Math.floor(Math.random()*t.length);cc.log(o);var c=t[o][0],e=t[o][1];this.position=this.positions[c][e];var i=cc.instantiate(this.blockPrefab);i.width=this.blockSize,i.height=this.blockSize,i.setPosition(this.position);var n=a[Math.floor(Math.random()*a.length)];return i.getComponent("block").setNumber(n),this.background.addChild(i),this.blocks[c][e]=i,this.data[c][e]=n,console.log("test"+n),!0},init:function(){if(this.updateScore(0),this.blocks)for(var t=0;t<this.blocks.length;t++)for(var o=0;o<this.blocks[t].length;o++)null!=this.blocks[t][o]&&this.blocks[t][o].destroy();this.blocks=[],this.data=[];for(var c=0;c<4;c++)this.blocks.push([null,null,null,null]),this.data.push([0,0,0,0]);this.addBlock(),this.addBlock(),this.addBlock()},updateScore:function(t){this.score=t,this.scoreTitle.string="\u5206\u6570 : "+t},gameover:function(){cc.log("gameover"),cc.director.loadScene("gameOver")},checkBlock:function(){for(var t=0;t<4;t++)for(var o=0;o<4;o++){var c=this.data[t][o];if(0==c)return!1;if(o>0&&o<4&&this.data[t][o-1]==c)return!1;if(o>0&&o<3&&this.data[t][o+1]==c)return!1;if(t>0&&o<4&&this.data[t-1][o]==c)return!1;if(t>0&&t<3&&this.data[t+1][o]==c)return!1}return!0},afterMove:function(t){t&&(this.updateScore(this.score+1),this.addBlock()),this.checkBlock()&&this.gameover()},doMove:function(t,o,c){var a=cc.moveTo(.1,o),e=cc.callFunc(function(){c&&c()});t.runAction(cc.sequence(a,e))},moveMag:function(t){var o=this;console.log(t),"left"==t?function(){for(var t=[],c=!1,a=function t(a,e,i){if(0!=e&&0!=o.data[a][e]){if(0==o.data[a][e-1]){var n=o.blocks[a][e],s=o.positions[a][e-1];o.blocks[a][e-1]=n,o.data[a][e-1]=o.data[a][e],o.data[a][e]=0,o.blocks[a][e]=null,o.doMove(n,s,function(){t(a,e-1,i)}),c=!0}else if(o.data[a][e]==o.data[a][e-1]){var r=o.blocks[a][e],l=o.positions[a][e-1];o.data[a][e-1]=2*o.data[a][e],o.data[a][e]=0,o.blocks[a][e]=null,cc.log("number"+o.data[a][e-1]),o.blocks[a][e-1].getComponent("block").setNumber(o.data[a][e-1]),o.doMove(r,l,function(){r.destroy(),i&&i()}),c=!0}else if(o.data[a][e]!=o.data[a][e-1])return void(i&&i())}else i&&i()},e=0;e<4;e++)for(var i=0;i<4;i++)0!=o.data[e][i]&&t.push({x:e,y:i});for(var n=0,s=0;s<t.length;s++)a(t[s].x,t[s].y,function(){++n==t.length&&o.afterMove(c)})}():"right"==t?function(){for(var t=[],c=!1,a=function t(a,e,i){if(3!=e&&0!=o.data[a][e]){if(0==o.data[a][e+1]){var n=o.blocks[a][e],s=o.positions[a][e+1];o.blocks[a][e+1]=n,o.data[a][e+1]=o.data[a][e],o.data[a][e]=0,o.blocks[a][e]=null,o.doMove(n,s,function(){t(a,e+1,i)}),c=!0}else if(o.data[a][e]==o.data[a][e+1]){var r=o.blocks[a][e],l=o.positions[a][e+1];o.data[a][e+1]=2*o.data[a][e],o.data[a][e]=0,o.blocks[a][e]=null,cc.log("number"+o.data[a][e+1]),o.blocks[a][e+1].getComponent("block").setNumber(o.data[a][e+1]),o.doMove(r,l,function(){r.destroy(),i&&i()}),c=!0}else if(o.data[a][e]!=o.data[a][e+1])return void(i&&i())}else i&&i()},e=0;e<4;e++)for(var i=3;i>=0;i--)0!=o.data[e][i]&&t.push({x:e,y:i});for(var n=0,s=0;s<t.length;s++)a(t[s].x,t[s].y,function(){++n==t.length&&o.afterMove(c)})}():"up"==t?function(){for(var t=[],c=!1,a=function t(a,e,i){if(3!=a&&0!=o.data[a][e]){if(0==o.data[a+1][e]){var n=o.blocks[a][e],s=o.positions[a+1][e];o.blocks[a+1][e]=n,o.data[a+1][e]=o.data[a][e],o.data[a][e]=0,o.blocks[a][e]=null,o.doMove(n,s,function(){t(a+1,e,i)}),c=!0}else if(o.data[a][e]==o.data[a+1][e]){var r=o.blocks[a][e],l=o.positions[a+1][e];o.data[a+1][e]=2*o.data[a][e],o.data[a][e]=0,o.blocks[a][e]=null,o.blocks[a+1][e].getComponent("block").setNumber(o.data[a+1][e]),o.doMove(r,l,function(){r.destroy(),i&&i()}),c=!0}else if(o.data[a][e]!=o.data[a+1][e])return void(i&&i())}else i&&i()},e=3;e>=0;e--)for(var i=0;i<4;i++)0!=o.data[e][i]&&t.push({x:e,y:i});for(var n=0,s=0;s<t.length;s++)a(t[s].x,t[s].y,function(){++n==t.length&&o.afterMove(c)})}():function(){for(var t=[],c=!1,a=function t(a,e,i){if(0!=a&&0!=o.data[a][e]){if(0==o.data[a-1][e]){var n=o.blocks[a][e],s=o.positions[a-1][e];o.blocks[a-1][e]=n,o.data[a-1][e]=o.data[a][e],o.data[a][e]=0,o.blocks[a][e]=null,o.doMove(n,s,function(){t(a-1,e,i)}),c=!0}else if(o.data[a][e]==o.data[a-1][e]){var r=o.blocks[a][e],l=o.positions[a-1][e];o.data[a-1][e]=2*o.data[a][e],o.data[a][e]=0,o.blocks[a][e]=null,o.blocks[a-1][e].getComponent("block").setNumber(o.data[a-1][e]),o.doMove(r,l,function(){r.destroy(),i&&i()}),c=!0}else if(o.data[a][e]!=o.data[a-1][e])return void(i&&i())}else i&&i()},e=0;e<4;e++)for(var i=0;i<4;i++)0!=o.data[e][i]&&t.push({x:e,y:i});for(var n=0,s=0;s<t.length;s++)a(t[s].x,t[s].y,function(){++n==t.length&&o.afterMove(c)})}()},addEventHandler:function(){var t=this;this.background.on("touchstart",function(o){t.startPoint=o.getLocation()}),this.background.on("touchend",function(o){t.endPoint=o.getLocation();var c=t.endPoint.sub(t.startPoint);c.mag()>50&&(Math.abs(c.x)>Math.abs(c.y)?c.x>0?t.moveMag("right"):t.moveMag("left"):c.y>0?t.moveMag("up"):t.moveMag("down"))})},start:function(){this.getblocks(),this.init(),this.addEventHandler()}}),cc._RF.pop()},{}],start:[function(t,o,c){"use strict";cc._RF.push(o,"2ee38CMCxxAIIy/MwAaP7uR","start"),cc.Class({extends:cc.Component,properties:{startLabel:cc.Node},onLoad:function(){this.startLabel.on(cc.Node.EventType.TOUCH_START,function(t){cc.director.loadScene("game")})}}),cc._RF.pop()},{}]},{},["block","colors","game","gameover","start"]);